(function(){"use strict";var t={8503:function(t,e,n){var s=n(144),o=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},i=[],r=n(1001),a={},l=(0,r.Z)(a,o,i,!1,null,null,null),u=l.exports,c=n(8345),d=function(){var t=this,e=t._self._c;return e("div",{staticClass:"chat-room"},[e("el-card",{staticClass:"box-card"},[e("div",{staticClass:"topTitle"},[t.onlineUserCount>1?e("h1",[t._v("下午茶猫猫屋("+t._s(t.onlineUserCount)+")")]):e("h1",[t._v("下午茶猫猫屋(1)")])]),e("div",{staticClass:"midMain"},[e("ul",t._l(t.msgList,(function(n){return e("li",{key:n.id},[e("div",[e("p",{staticClass:"timeP"},[t._v(t._s(n.sendTime))]),t._v(" "+t._s(n.user)+":"),e("span",{staticClass:"msgSpan"},[t._v(t._s(n.msg))]),e("p",{staticClass:"regionP"},[t._v("IP:"+t._s(n.region))])])])})),0)]),e("div",{staticClass:"bottomBg"},[e("div",{staticClass:"bottom-box"},[e("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"请输入内容"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMessage.apply(null,arguments)}},model:{value:t.nMsg,callback:function(e){t.nMsg=e},expression:"nMsg"}}),e("el-button",{attrs:{round:""},on:{click:t.sendMessage}},[t._v("发送")])],1)])])],1)},m=[],f=(n(7658),{data(){return{message:"你好",nMsg:"",msgList:[],ws:null}},mounted(){this.initializeWebSocket()},computed:{onlineUserCount(){const t=new Set;return this.msgList.forEach((e=>{t.add(e.user)})),t.size}},methods:{initializeWebSocket(){this.ws=new WebSocket("ws://127.0.0.1:8000"),this.ws.onopen=()=>{console.log("WebSocket连接已打开"),this.ws.send("success")},this.ws.onmessage=t=>{if(this.message=t.data,"success"!==this.message){const t=JSON.parse(this.message),e=JSON.parse(t.content);this.msgList.push(e)}},this.ws.onerror=()=>{console.error("WebSocket连接出错")}},sendMessage(){if(""===this.nMsg)return;const t=this.nMsg,e=localStorage.getItem("username"),n=localStorage.getItem("region"),s=this.getFormattedTime();""!==t&&(this.ws.send(JSON.stringify({id:Math.floor(1e4*Math.random()),user:e,sendTime:s,msg:this.nMsg,region:n})),this.nMsg="")},getFormattedTime(){const t=new Date,e=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0"),s=String(t.getSeconds()).padStart(2,"0"),o=`${e}:${n}:${s}`;return o},textenter(){console.log(123)}}}),g=f,h=(0,r.Z)(g,d,m,!1,null,"66932adb",null),p=h.exports,v=function(){var t=this,e=t._self._c;return e("div",{staticClass:"login"},[e("el-card",{staticClass:"box-card"},[e("div",{staticClass:"topTitle"},[e("div",{staticClass:"Ltitle"},[e("h2",[t._v("猫猫茶馆")])])]),e("div",{staticClass:"midMain"},[e("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[e("el-form-item",{staticClass:"formitem-hightline",attrs:{label:"用户名"}},[e("el-input",{staticClass:"el-input-width",model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),e("el-form-item",{staticClass:"formitem-hightline",attrs:{label:"用户IP"}},[e("el-input",{staticClass:"el-input-width",attrs:{disabled:""},model:{value:t.form.region,callback:function(e){t.$set(t.form,"region",e)},expression:"form.region"}}),e("el-button",{staticClass:"get-region-btn",attrs:{round:""},on:{click:t.getProvince}},[t._v("获取定位")])],1),e("el-form-item",{staticClass:"enterRoom formitem-hightline"},[e("el-button",{attrs:{type:"primary",round:""},on:{click:t.onSubmit}},[t._v("进入")])],1)],1)],1),e("div",{staticClass:"test"},[e("div")])])],1)},b=[],S=n(6154),w={data(){return{form:{username:"",region:""}}},methods:{onSubmit(){return""===this.form.username?alert("请填写用户名"):""===this.form.region?alert("请使用定位"):(localStorage.setItem("username",this.form.username),localStorage.setItem("region",this.form.region),void this.$router.push("/wsuse"))},getProvince(){S.Z.get("https://api.ipify.org?format=json").then((t=>{const e=t.data.ip;S.Z.get(`https://ipapi.co/${e}/json/`).then((t=>{this.form.region=t.data.region})).catch((t=>{console.log(t)}))})).catch((t=>{console.log(t)}))}}},C=w,_=(0,r.Z)(C,v,b,!1,null,"7576dd4e",null),y=_.exports;s["default"].use(c.ZP);const k=[{path:"/",name:"relogin",component:y,redirect:"/login"},{path:"/wsuse",name:"Wsuse",component:p},{path:"/login",name:"Login",component:y}],M=new c.ZP({routes:k});M.beforeEach(((t,e,n)=>{const s=localStorage.getItem("username"),o=localStorage.getItem("region");s||o?n():"Login"!==t.name?n({name:"Login"}):n()}));var O=M,x=n(4720),P=n.n(x);s["default"].config.productionTip=!1,s["default"].use(P()),new s["default"]({router:O,render:t=>t(u)}).$mount("#app")}},e={};function n(s){var o=e[s];if(void 0!==o)return o.exports;var i=e[s]={id:s,loaded:!1,exports:{}};return t[s].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=t,function(){n.amdO={}}(),function(){var t=[];n.O=function(e,s,o,i){if(!s){var r=1/0;for(c=0;c<t.length;c++){s=t[c][0],o=t[c][1],i=t[c][2];for(var a=!0,l=0;l<s.length;l++)(!1&i||r>=i)&&Object.keys(n.O).every((function(t){return n.O[t](s[l])}))?s.splice(l--,1):(a=!1,i<r&&(r=i));if(a){t.splice(c--,1);var u=o();void 0!==u&&(e=u)}}return e}i=i||0;for(var c=t.length;c>0&&t[c-1][2]>i;c--)t[c]=t[c-1];t[c]=[s,o,i]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,s){var o,i,r=s[0],a=s[1],l=s[2],u=0;if(r.some((function(e){return 0!==t[e]}))){for(o in a)n.o(a,o)&&(n.m[o]=a[o]);if(l)var c=l(n)}for(e&&e(s);u<r.length;u++)i=r[u],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(c)},s=self["webpackChunkwsdemo"]=self["webpackChunkwsdemo"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=n.O(void 0,[998],(function(){return n(8503)}));s=n.O(s)})();
//# sourceMappingURL=app.2aee6154.js.map